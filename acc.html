<html>
    <head>
    </head>
    <body>
        <div id="sensor">Sensor</div>
        <script>
            window.addEventListener('click', function() {
                window.location.reload();
            });
            var sensor = document.querySelector('#sensor');
            var count = 0;
            var lastDir = 0;
            var vibrations = 0;
            var listening = true;

            // setInterval(function() {

            // }, 3000);

            function deviceOrientationHandler(tiltLR, tiltFB, dir) {
                if (!listening) {
                     return;
                }
                // console.log('gamma', tiltLR);
                // console.log('beta', tiltFB);
                console.log('alpha', dir);
                console.log('alpha difference', Math.abs(dir - lastDir));
                if (Math.abs(dir - lastDir) > 1) {
                    console.log('vibrating');
                    vibrations++;
                    lastVibration = new Date();
                }
                if (vibrations > 10 && lastVibration && new Date() - lastVibration > 2000) {
                    listening = false;
                    console.log('not vibrating');
                }
                // if (Math.abs(dir - lastDir)) > 1.0) {
                //     console.log('shaking');
                // }
                lastDir = dir;
            }

            window.addEventListener('deviceorientation', function(event) {
                console.log('[sensor] deviceorientation');

                // gamma is the left-to-right tilt in degrees, where right is positive
                var tiltLR = event.gamma;

                // beta is the front-to-back tilt in degrees, where front is positive
                var tiltFB = event.beta;

                // alpha is the compass direction the device is facing in degrees
                var dir = event.alpha;

                // call our orientation event handler
                deviceOrientationHandler(tiltLR, tiltFB, dir);

              }, false);
        </script>
    </body>
</html>
